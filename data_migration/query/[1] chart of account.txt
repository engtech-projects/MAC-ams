TRUNCATE TABLE chart_of_accounts;
INSERT INTO chart_of_accounts ( account_number, account_name, account_description, account_type_id, bank_reconcillation, STATUS, type ) 
(
	SELECT
		ACCT_NO AS "account_number",
		TITLE AS "account_name",
		TITLE AS "account_description",
		(CASE
				WHEN ACCT_NO >= 1000 AND ACCT_NO <= 1900 THEN 
																											(
																												SELECT account_type_id FROM account_type 
																												WHERE account_category_id = 1 AND account_no <= ACCT_NO 
																												ORDER BY abs(account_no - ACCT_NO), account_no DESC
																												LIMIT 1
																											)
				WHEN ACCT_NO >= 2000 AND ACCT_NO <= 2900 THEN 
																											(
																												SELECT account_type_id FROM account_type 
																												WHERE account_category_id = 2 AND account_no <= ACCT_NO 
																												ORDER BY abs(account_no - ACCT_NO), account_no DESC
																												LIMIT 1
																											)
				WHEN ACCT_NO >= 3000 AND ACCT_NO <= 3900 THEN 
																											(
																												SELECT account_type_id FROM account_type 
																												WHERE account_category_id = 3 AND account_no <= ACCT_NO 
																												ORDER BY abs(account_no - ACCT_NO), account_no DESC
																												LIMIT 1
																											)
				WHEN ACCT_NO >= 4000 AND ACCT_NO <= 4900 THEN 
																											(
																												SELECT account_type_id FROM account_type 
																												WHERE account_category_id = 4 AND account_no <= ACCT_NO 
																												ORDER BY abs(account_no - ACCT_NO), account_no DESC
																												LIMIT 1
																											)
				WHEN ACCT_NO >= 5000 AND ACCT_NO <= 5900 THEN 
																											(
																												SELECT account_type_id FROM account_type 
																												WHERE account_category_id = 5 AND account_no <= ACCT_NO 
																												ORDER BY abs(account_no - ACCT_NO), account_no DESC
																												LIMIT 1
																											)
				ELSE 0																																																
		END) AS "account_type_id",
		IF ( BANK_REC = "N", "no", "yes" ) AS "bank_reconcillation",
		"active",
		TYPE AS "type"
	FROM
	glacct 
	)